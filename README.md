üíò Lovely JAX
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

<div>

## [Read full docs](https://xl0.github.io/lovely-jax) \| ‚ù§Ô∏è [Lovely Tensors](https://github.com/xl0/lovely-tensors) \| üíü [Lovely `NumPy`](https://github.com/xl0/lovely-numpy) \| [Discord](https://discord.gg/4NxRV7NH)

</div>

## Note: I‚Äôm pretty new to JAX.

If something does not make sense, shoot me an
[Issue](https://github.com/xl0/lovely-jax/issues) and let me know how
it‚Äôs supposed to work!

## Install

``` sh
pip install lovely-jax
```

## How to use

How often do you find yourself debugging JAX code? You dump an array to
the cell output, and see this:

``` python
numbers
```

    DeviceArray([[[-0.354, -0.337, -0.405, ..., -0.56 , -0.474,  2.249],
                  [-0.405, -0.423, -0.491, ..., -0.919, -0.851,  2.163],
                  [-0.474, -0.474, -0.542, ..., -1.039, -1.039,  2.198],
                  ...,
                  [-0.902, -0.834, -0.936, ..., -1.467, -1.296,  2.232],
                  [-0.851, -0.782, -0.936, ..., -1.604, -1.501,  2.18 ],
                  [-0.834, -0.816, -0.971, ..., -1.656, -1.553,  2.112]],

                 [[-0.197, -0.197, -0.303, ..., -0.478, -0.373,  2.411],
                  [-0.25 , -0.232, -0.338, ..., -0.705, -0.67 ,  2.359],
                  [-0.303, -0.285, -0.39 , ..., -0.74 , -0.81 ,  2.376],
                  ...,
                  [-0.425, -0.232, -0.373, ..., -1.09 , -1.02 ,  2.429],
                  [-0.39 , -0.232, -0.425, ..., -1.23 , -1.23 ,  2.411],
                  [-0.408, -0.285, -0.478, ..., -1.283, -1.283,  2.341]],

                 [[-0.672, -0.985, -0.881, ..., -0.968, -0.689,  2.396],
                  [-0.724, -1.072, -0.968, ..., -1.247, -1.02 ,  2.326],
                  [-0.828, -1.125, -1.02 , ..., -1.264, -1.16 ,  2.379],
                  ...,
                  [-1.229, -1.473, -1.386, ..., -1.508, -1.264,  2.518],
                  [-1.194, -1.456, -1.421, ..., -1.648, -1.473,  2.431],
                  [-1.229, -1.526, -1.508, ..., -1.682, -1.526,  2.361]]], dtype=float32)

Was it really useful for you, as a human, to see all these numbers?

What is the shape? The size?  
What are the statistics?  
Are any of the values `nan` or `inf`?  
Is it an image of a man holding a tench?

``` python
import lovely_jax as lj
```

``` python
lj.monkey_patch()
```

## `__repr__`

``` python
numbers # torch.Tensor
```

    DeviceArray[196, 196, 3] n=115248 x‚àà[-2.118, 2.640] Œº=-0.388 œÉ=1.073 gpu:0

Better, huh?

``` python
numbers[1,:6,1] # Still shows values if there are not too many.
```

    DeviceArray[6] x‚àà[-0.408, -0.232] Œº=-0.340 œÉ=0.075 gpu:0 [-0.250, -0.232, -0.338, -0.408, -0.408, -0.408]

``` python
spicy = numbers.flatten()[:12].copy()

spicy = (spicy  .at[0].mul(10000)
                .at[1].divide(10000)
                .at[2].set(float('inf'))
                .at[3].set(float('-inf'))
                .at[4].set(float('nan'))
                .reshape((2,6)))
spicy # Spicy stuff
```

    DeviceArray[2, 6] n=12 x‚àà[-3.541e+03, -1.975e-05] Œº=-393.848 œÉ=1.180e+03 +Inf! -Inf! NaN! gpu:0

``` python
jnp.zeros((10, 10)) # A zero tensor - make it obvious
```

    DeviceArray[10, 10] all_zeros gpu:0

``` python
spicy.v # Verbose
```

    DeviceArray[2, 6] n=12 x‚àà[-3.541e+03, -1.975e-05] Œº=-393.848 œÉ=1.180e+03 +Inf! -Inf! NaN! gpu:0
    DeviceArray([[-3.541e+03, -1.975e-05,        inf,       -inf,        nan, -9.853e-01],
                 [-4.054e-01, -3.025e-01, -8.807e-01, -4.397e-01, -3.025e-01, -7.761e-01]], dtype=float32)

``` python
spicy.p # The plain old way
```

    DeviceArray([[-3.541e+03, -1.975e-05,        inf,       -inf,        nan, -9.853e-01],
                 [-4.054e-01, -3.025e-01, -8.807e-01, -4.397e-01, -3.025e-01, -7.761e-01]], dtype=float32)

## Going `.deeper`

``` python
numbers.deeper
```

    DeviceArray[196, 196, 3] n=115248 x‚àà[-2.118, 2.640] Œº=-0.388 œÉ=1.073 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.912, 2.411] Œº=-0.728 œÉ=0.519 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.861, 2.359] Œº=-0.778 œÉ=0.450 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.758, 2.379] Œº=-0.838 œÉ=0.437 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.656, 2.466] Œº=-0.878 œÉ=0.415 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.717, 2.448] Œº=-0.882 œÉ=0.399 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.717, 2.431] Œº=-0.905 œÉ=0.408 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.563, 2.448] Œº=-0.859 œÉ=0.416 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.475, 2.431] Œº=-0.791 œÉ=0.463 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.526, 2.429] Œº=-0.759 œÉ=0.499 gpu:0
      ...

``` python
# You can go deeper if you need to
numbers[:3,:5,:3].deeper(2)
```

    DeviceArray[3, 5, 3] n=45 x‚àà[-1.316, -0.197] Œº=-0.593 œÉ=0.302 gpu:0
      DeviceArray[5, 3] n=15 x‚àà[-0.985, -0.197] Œº=-0.491 œÉ=0.267 gpu:0
        DeviceArray[3] x‚àà[-0.672, -0.197] Œº=-0.408 œÉ=0.197 gpu:0 [-0.354, -0.197, -0.672]
        DeviceArray[3] x‚àà[-0.985, -0.197] Œº=-0.507 œÉ=0.343 gpu:0 [-0.337, -0.197, -0.985]
        DeviceArray[3] x‚àà[-0.881, -0.303] Œº=-0.530 œÉ=0.252 gpu:0 [-0.405, -0.303, -0.881]
        DeviceArray[3] x‚àà[-0.776, -0.303] Œº=-0.506 œÉ=0.199 gpu:0 [-0.440, -0.303, -0.776]
        DeviceArray[3] x‚àà[-0.916, -0.215] Œº=-0.506 œÉ=0.298 gpu:0 [-0.388, -0.215, -0.916]
      DeviceArray[5, 3] n=15 x‚àà[-1.212, -0.232] Œº=-0.609 œÉ=0.302 gpu:0
        DeviceArray[3] x‚àà[-0.724, -0.250] Œº=-0.460 œÉ=0.197 gpu:0 [-0.405, -0.250, -0.724]
        DeviceArray[3] x‚àà[-1.072, -0.232] Œº=-0.576 œÉ=0.360 gpu:0 [-0.423, -0.232, -1.072]
        DeviceArray[3] x‚àà[-0.968, -0.338] Œº=-0.599 œÉ=0.268 gpu:0 [-0.491, -0.338, -0.968]
        DeviceArray[3] x‚àà[-0.968, -0.408] Œº=-0.651 œÉ=0.235 gpu:0 [-0.577, -0.408, -0.968]
        DeviceArray[3] x‚àà[-1.212, -0.408] Œº=-0.761 œÉ=0.336 gpu:0 [-0.662, -0.408, -1.212]
      DeviceArray[5, 3] n=15 x‚àà[-1.316, -0.285] Œº=-0.677 œÉ=0.306 gpu:0
        DeviceArray[3] x‚àà[-0.828, -0.303] Œº=-0.535 œÉ=0.219 gpu:0 [-0.474, -0.303, -0.828]
        DeviceArray[3] x‚àà[-1.125, -0.285] Œº=-0.628 œÉ=0.360 gpu:0 [-0.474, -0.285, -1.125]
        DeviceArray[3] x‚àà[-1.020, -0.390] Œº=-0.651 œÉ=0.268 gpu:0 [-0.542, -0.390, -1.020]
        DeviceArray[3] x‚àà[-1.003, -0.478] Œº=-0.708 œÉ=0.219 gpu:0 [-0.645, -0.478, -1.003]
        DeviceArray[3] x‚àà[-1.316, -0.513] Œº=-0.865 œÉ=0.336 gpu:0 [-0.765, -0.513, -1.316]

``` python
# __tracebackhide__=False

# def f(x):
#     __tracebackhide__=False

#     jax.debug.print(" sdfs {x} sfsdf", x=x)
#     jax.debug.print(" sdfs {x} sfsdf", x=type(x))
#     return x*2

# fj = jax.jit(f)

# _ = fj(numbers)


# # print(numbers)
```

``` python
print(repr(numbers))
```

    DeviceArray[196, 196, 3] n=115248 x‚àà[-2.118, 2.640] Œº=-0.388 œÉ=1.073 gpu:0

## Without `monkey_patch()`

``` python
lj.lovely(spicy)
```

    DeviceArray[2, 6] n=12 x‚àà[-3.541e+03, -1.975e-05] Œº=-393.848 œÉ=1.180e+03 +Inf! -Inf! NaN! gpu:0

``` python
lj.lovely(spicy, verbose=True)
```

    DeviceArray[2, 6] n=12 x‚àà[-3.541e+03, -1.975e-05] Œº=-393.848 œÉ=1.180e+03 +Inf! -Inf! NaN! gpu:0
    DeviceArray([[-3.541e+03, -1.975e-05,        inf,       -inf,        nan, -9.853e-01],
                 [-4.054e-01, -3.025e-01, -8.807e-01, -4.397e-01, -3.025e-01, -7.761e-01]], dtype=float32)

``` python
lj.lovely(numbers, depth=1)
```

    DeviceArray[196, 196, 3] n=115248 x‚àà[-2.118, 2.640] Œº=-0.388 œÉ=1.073 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.912, 2.411] Œº=-0.728 œÉ=0.519 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.861, 2.359] Œº=-0.778 œÉ=0.450 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.758, 2.379] Œº=-0.838 œÉ=0.437 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.656, 2.466] Œº=-0.878 œÉ=0.415 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.717, 2.448] Œº=-0.882 œÉ=0.399 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.717, 2.431] Œº=-0.905 œÉ=0.408 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.563, 2.448] Œº=-0.859 œÉ=0.416 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.475, 2.431] Œº=-0.791 œÉ=0.463 gpu:0
      DeviceArray[196, 3] n=588 x‚àà[-1.526, 2.429] Œº=-0.759 œÉ=0.499 gpu:0
      ...
